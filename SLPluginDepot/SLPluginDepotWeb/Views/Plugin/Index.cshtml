@model IEnumerable<Plugin>

@{
    ViewData["Title"] = "Plugin Browser";
}

<h2>Search for Plugins in here!</h2>

<!-- Search Bar -->
<form method="get" asp-controller="Plugin" asp-action="Search" class="mb-4">
    <div class="input-group">
        <input type="text" name="query" class="form-control" placeholder="Enter plugin name..." />
        <button type="submit" class="btn btn-primary">Search</button>
    </div>
</form>

<!-- Display Plugins -->
@if (Model != null && Model.Any())
{
    <div class="plugin-grid">
        @foreach (var plugin in Model)
        {
            <a href="@Url.Action("Details", "Plugin", new { id = plugin.Id })" class="plugin-card-link">
                <div class="plugin-card" style="background-image: url('@plugin.BackgroundImageUrl'); background-size: cover; background-position: center;">
                    <div class="plugin-overlay">
                        <h3>@plugin.Name</h3>
                        <p>Rating: @(plugin.Ratings?.Any() == true ? plugin.Ratings.Average(r => r.Stars).ToString("0.0") : "No ratings")</p>
                    </div>
                </div>
            </a>
        }
    </div>
}
else if (Model != null)
{
    <p>No plugins found matching your query.</p>
}

<!-- Button to Add New Plugin -->
<div class="mt-4">
    <a href="@Url.Action("AddPlugin", "Plugin")" class="btn btn-success">Add New Plugin</a>
</div>

<style>
    .plugin-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
        gap: 20px;
    }

    .plugin-card-link {
        text-decoration: none;
        color: inherit;
    }

    .plugin-card {
        height: 200px;
        position: relative;
        border-radius: 10px;
        overflow: hidden;
        box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        transition: transform 0.2s;
    }

        .plugin-card:hover {
            transform: scale(1.03);
        }

    .plugin-overlay {
        background-color: rgba(0, 0, 0, 0.6);
        color: #fff;
        padding: 10px;
        position: absolute;
        bottom: 0;
        width: 100%;
    }
</style>
